<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">test/Hyperwallet.spec.js | Hyperwallet REST SDK</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="A library to manage users, transfer methods and payments through the Hyperwallet API"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Hyperwallet REST SDK"><meta property="twitter:description" content="A library to manage users, transfer methods and payments through the Hyperwallet API"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/hyperwallet/node-sdk"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Hyperwallet.js~Hyperwallet.html">Hyperwallet</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils">utils</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/ApiClient.js~ApiClient.html">ApiClient</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/utils/Encryption.js~Encryption.html">Encryption</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-api-callback">api-callback</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">test/Hyperwallet.spec.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import chai, { expect } from &quot;chai&quot;;
import dirtyChai from &quot;dirty-chai&quot;;
import sinon from &quot;sinon&quot;;
import sinonChai from &quot;sinon-chai&quot;;

import Hyperwallet from &quot;../src/Hyperwallet&quot;;
import ApiClient from &quot;../src/utils/ApiClient&quot;;

chai.should();
chai.use(dirtyChai);
chai.use(sinonChai);

/** @test {Hyperwallet} */
describe(&quot;Hyperwallet&quot;, () =&gt; {
    /** @test {Hyperwallet#constructor} */
    describe(&quot;constructor()&quot;, () =&gt; {
        /** @test {Hyperwallet#constructor} */
        it(&quot;should initialize ApiClient with default server&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client.username.should.be.equal(&quot;test-username&quot;);
            client.client.password.should.be.equal(&quot;test-password&quot;);
            client.client.server.should.be.equal(&quot;https://api.sandbox.hyperwallet.com&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should set programToken to undefined if not provided&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            expect(client.programToken).to.be.undefined();
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should set programToken if provided&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                programToken: &quot;test-program-token&quot;,
            });

            client.programToken.should.be.equal(&quot;test-program-token&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should initialize ApiClient with provided server&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                server: &quot;test-server&quot;,
            });

            client.client.server.should.be.equal(&quot;test-server&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should throw error if username is missing&quot;, () =&gt; {
            expect(() =&gt; new Hyperwallet({
                password: &quot;test-password&quot;,
            })).to.throw(&quot;You need to specify your API username and password!&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should throw error if password is missing&quot;, () =&gt; {
            expect(() =&gt; new Hyperwallet({
                username: &quot;test-username&quot;,
            })).to.throw(&quot;You need to specify your API username and password!&quot;);
        });

        /** @test {Hyperwallet#constructor} */
        it(&quot;should throw error if username and password is missing&quot;, () =&gt; {
            expect(() =&gt; new Hyperwallet({
            })).to.throw(&quot;You need to specify your API username and password!&quot;);
        });
    });

    //--------------------------------------
    // TLS verification
    //--------------------------------------

    describe(&quot;listUsers()&quot;, () =&gt; {
        it(&quot;should not have any TLS issues&quot;, (cb) =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.listUsers({}, (err, body, res) =&gt; {
                res.status.should.be.equal(401);
                cb();
            });
        });
    });

    //--------------------------------------
    // Helpers
    //--------------------------------------

    /** @test {Hyperwallet#formatResForCallback} */
    describe(&quot;formatResForCallback()&quot;, () =&gt; {
        /** @test {Hyperwallet#formatResForCallback} */
        it(&quot;should return a formated response body, parse reasons&quot;, () =&gt; {
            const uploadRejectionData = {
                body: {
                    token: &quot;tkn-12345&quot;,
                    documents: [{
                        category: &quot;IDENTIFICATION&quot;,
                        type: &quot;DRIVERS_LICENSE&quot;,
                        country: &quot;AL&quot;,
                        status: &quot;INVALID&quot;,
                        reasons: [
                            {
                                name: &quot;DOCUMENT_CORRECTION_REQUIRED&quot;,
                                description: &quot;Document requires correction&quot;,
                            },
                            {
                                name: &quot;DOCUMENT_NOT_DECISIVE&quot;,
                                description: &quot;Decision cannot be made based on document. Alternative document required&quot;,
                            },
                        ],
                        createdOn: &quot;2020-11-24T19:05:02&quot;,
                    }],
                },
            };
            const formattedRes = ApiClient.formatResForCallback(uploadRejectionData);
            expect(formattedRes.body.documents[0].type).to.equal(uploadRejectionData.body.documents[0].type);
            expect(formattedRes.body.documents[0].reasons[0].name).to.equal(uploadRejectionData.body.documents[0].reasons[0].name);
            expect(formattedRes.body.documents[0].createdOn).to.equal(uploadRejectionData.body.documents[0].createdOn);
        });

        /** @test {Hyperwallet#formatResForCallback} */
        it(&quot;should return a formated response body, parse documents&quot;, () =&gt; {
            const uploadRejectionData = {
                body: {
                    token: &quot;tkn-12345&quot;,
                    documents: [{
                        category: &quot;IDENTIFICATION&quot;,
                        type: &quot;DRIVERS_LICENSE&quot;,
                        country: &quot;AL&quot;,
                        status: &quot;NEW&quot;,
                        createdOn: &quot;2020-11-24T19:05:02&quot;,
                    }],
                },
            };
            const formattedRes = ApiClient.formatResForCallback(uploadRejectionData);
            expect(formattedRes.body.documents[0].type).to.equal(uploadRejectionData.body.documents[0].type);
            expect(formattedRes.body.documents[0].createdOn).to.equal(uploadRejectionData.body.documents[0].createdOn);
        });

        /** @test {Hyperwallet#formatResForCallback} */
        it(&quot;should not modify response body with no documents&quot;, () =&gt; {
            const uploadData = { body: { token: &quot;tkn-12345&quot; } };
            const formattedRes = ApiClient.formatResForCallback(uploadData);
            expect(formattedRes.body.token).to.equal(uploadData.body.token);
        });
    });
    //--------------------------------------
    // Users
    //--------------------------------------

    /** @test {Hyperwallet#createUser} */
    describe(&quot;createUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createUser} */
        it(&quot;should do post call to users endpoint without programToken added&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createUser({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });

        /** @test {Hyperwallet#createUser} */
        it(&quot;should do post call to users endpoint with programToken added&quot;, () =&gt; {
            client.programToken = &quot;test-program-token&quot;;

            const callback = () =&gt; null;
            client.createUser({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {
                test: &quot;value&quot;,
                programToken: &quot;test-program-token&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getUser} */
    describe(&quot;getUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getUser} */
        it(&quot;should do get call if userToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updateUser} */
    describe(&quot;updateUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateUser(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateUser} */
        it(&quot;should do put call to users endpoint without programToken added&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateUser(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });

        /** @test {Hyperwallet#updateUser} */
        it(&quot;should do put call to users endpoint with programToken added&quot;, () =&gt; {
            client.programToken = &quot;test-program-token&quot;;

            const callback = () =&gt; null;
            client.updateUser(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token&quot;, {
                test: &quot;value&quot;,
                programToken: &quot;test-program-token&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listUsers} */
    describe(&quot;listUsers()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listUsers} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                clientUserId: &quot;test-client-user-id&quot;,
                email: &quot;test-email&quot;,
                programToken: &quot;test-programToken&quot;,
                status: &quot;test-status&quot;,
                verificationStatus: &quot;test-verificationStatus&quot;,
                taxVerificationStatus: &quot;test-taxVerificationStatus&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listUsers(options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, options);
        });

        /** @test {Hyperwallet#listUsers} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listUsers({ clientUserId: &quot;test-client-user-id&quot;, test1: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - clientUserId,email,programToken,status,verificationStatus,taxVerificationStatus,createdBefore,createdAfter,sortBy,limit&quot;);
        });
        /** @test {Hyperwallet#listUsers} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listUsers({}, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {});
        });

        /** @test {Hyperwallet#listUsers} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listUsers({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#activateUser} */
    describe(&quot;activateUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#activateUser}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.activateUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#activateUser}
         */
        it(&quot;should send transition to &apos;ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.activateUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {
                transition: &quot;ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#deactivateUser} */
    describe(&quot;deactivateUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#deactivateUser}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#deactivateUser}
         */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivateUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#lockUser} */
    describe(&quot;lockUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#lockUser}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.lockUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#lockUser}
         */
        it(&quot;should send transition to &apos;LOCKED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.lockUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {
                transition: &quot;LOCKED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#freezeUser} */
    describe(&quot;freezeUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#freezeUser}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.freezeUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#freezeUser}
         */
        it(&quot;should send transition to &apos;FROZEN&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.freezeUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {
                transition: &quot;FROZEN&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#preactivateUser} */
    describe(&quot;preactivateUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#preactivateUser}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.preactivateUser(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#preactivateUser}
         */
        it(&quot;should send transition to &apos;PRE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.preactivateUser(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {
                transition: &quot;PRE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createUserStatusTransition} */
    describe(&quot;createUserStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createUserStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createUserStatusTransition(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createUserStatusTransition} */
        it(&quot;should send post call to user status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createUserStatusTransition(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getUserStatusTransition} */
    describe(&quot;getUserStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getUserStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getUserStatusTransition(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getUserStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getUserStatusTransition(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getUserStatusTransition} */
        it(&quot;should do get call if userToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getUserStatusTransition(&quot;test-user-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listUserStatusTransitions} */
    describe(&quot;listUserStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listUserStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listUserStatusTransitions(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listUserStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listUserStatusTransitions(&quot;test-user-token&quot;, { transition: &quot;test-transition&quot;, test1: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listUserStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listUserStatusTransitions(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listUserStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listUserStatusTransitions(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listUserStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listUserStatusTransitions(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    describe(&quot;uploadDocuments()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPutMultipart: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#uploadDocuments} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.uploadDocuments(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#uploadDocuments} */
        it(&quot;should throw error if data is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.uploadDocuments(&quot;test-user-token&quot;, null, callback)).to.throw(&quot;Files for upload are require&quot;);
        });


        /** @test {Hyperwallet#uploadDocuments} */
        it(&quot;should do put call to upload multipart&quot;, () =&gt; {
            const callback = () =&gt; null;

            client.uploadDocuments(&quot;users/test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
        });
    });

    //--------------------------------------
    // Bank Cards
    //--------------------------------------

    /** @test {Hyperwallet#createBankCard} */
    describe(&quot;createBankCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBankCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankCard(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankCard} */
        it(&quot;should do post call to bank cards endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBankCard(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getBankCard} */
    describe(&quot;getBankCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getBankCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankCard(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankCard} */
        it(&quot;should throw error if bankCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankCard(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;bankCardToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankCard} */
        it(&quot;should do get call if userToken and bankCardToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getBankCard(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updateBankCard} */
    describe(&quot;updateBankCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateBankCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBankCard(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBankCard} */
        it(&quot;should throw error if bankCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBankCard(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;bankCardToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBankCard} */
        it(&quot;should do put call to bank cards endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateBankCard(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBankCards} */
    describe(&quot;listBankCards()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBankCards} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankCards(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankCards} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                status: &quot;test-status&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listBankCards(&quot;test-user-token&quot;, options, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards&quot;, options);
        });

        /** @test {Hyperwallet#listBankCards} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankCards(&quot;test-user-token&quot;, { status: &quot;test-status&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBankCards} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankCards(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards&quot;, {});
        });

        /** @test {Hyperwallet#listBankCards} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBankCards(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#deactivateBankCard} */
    describe(&quot;deactivate()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#deactivateBankCard}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBankCard(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#deactivateBankCard}
         */
        it(&quot;should throw error if bankCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBankCard(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;bankCardToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#deactivateBankCard}
         */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivateBankCard(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createBankCardStatusTransition} */
    describe(&quot;createBankCardStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBankCardStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankCardStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankCardStatusTransition} */
        it(&quot;should throw error if bankCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankCardStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;bankCardToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankCardStatusTransition} */
        it(&quot;should send post call to bank card status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBankCardStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getBankCardStatusTransition} */
    describe(&quot;getBankCardStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getBankCardStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankCardStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankCardStatusTransition} */
        it(&quot;should throw error if bankCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankCardStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;bankCardToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankCardStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankCardStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankCardStatusTransition} */
        it(&quot;should do get call if userToken, bankCardToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getBankCardStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBankCardStatusTransitions} */
    describe(&quot;listBankCardStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBankCardStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankCardStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankCardStatusTransitions} */
        it(&quot;should throw error if bankCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankCardStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;bankCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankCardStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listBankCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listBankCardStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBankCardStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listBankCardStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBankCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-cards/test-bank-card-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Authentication Token
    //--------------------------------------

    /** @test {Hyperwallet#getAuthenticationToken} */
    describe(&quot;getAuthenticationToken()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getAuthenticationToken} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getAuthenticationToken(undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getAuthenticationToken} */
        it(&quot;should do post call to authentication token endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getAuthenticationToken(&quot;test-user-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/authentication-token&quot;, {}, {}, callback);
        });
    });

    //--------------------------------------
    // Paper Checks
    //--------------------------------------

    /** @test {Hyperwallet#createPaperCheck} */
    describe(&quot;createPaperCheck()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPaperCheck} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPaperCheck(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPaperCheck} */
        it(&quot;should do post call to paper checks endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPaperCheck(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPaperCheck} */
    describe(&quot;getPaperCheck()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPaperCheck} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaperCheck(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaperCheck} */
        it(&quot;should throw error if paperCheckToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaperCheck(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;paperCheckToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaperCheck} */
        it(&quot;should do get call if userToken and paperCheckToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPaperCheck(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updatePaperCheck} */
    describe(&quot;updatePaperCheck()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updatePaperCheck} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePaperCheck(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePaperCheck} */
        it(&quot;should throw error if paperCheckToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePaperCheck(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;paperCheckToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePaperCheck} */
        it(&quot;should do put call to paper checks endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updatePaperCheck(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPaperChecks} */
    describe(&quot;listPaperChecks()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPaperChecks} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaperChecks(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPaperChecks} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                status: &quot;test-status&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listPaperChecks(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks&quot;, options);
        });

        /** @test {Hyperwallet#listPaperChecks} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaperChecks(&quot;test-user-token&quot;, { status: &quot;test-status&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPaperChecks} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPaperChecks(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks&quot;, {});
        });

        /** @test {Hyperwallet#listPaperChecks} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPaperChecks(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#deactivatePaperCheck} */
    describe(&quot;deactivate()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /**
         * @test {Hyperwallet#deactivatePaperCheck}
         */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivatePaperCheck(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#deactivatePaperCheck}
         */
        it(&quot;should throw error if paperCheckToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivatePaperCheck(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;paperCheckToken is required&quot;);
        });

        /**
         * @test {Hyperwallet#deactivatePaperCheck}
         */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivatePaperCheck(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createPaperCheckStatusTransition} */
    describe(&quot;createPaperCheckStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPaperCheckStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPaperCheckStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPaperCheckStatusTransition} */
        it(&quot;should throw error if paperCheckToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPaperCheckStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;paperCheckToken is required&quot;);
        });

        /** @test {Hyperwallet#createPaperCheckStatusTransition} */
        it(&quot;should send post call to paper check status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPaperCheckStatusTransition(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPaperCheckStatusTransition} */
    describe(&quot;getPaperCheckStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPaperCheckStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaperCheckStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaperCheckStatusTransition} */
        it(&quot;should throw error if paperCheckToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaperCheckStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;paperCheckToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaperCheckStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaperCheckStatusTransition(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaperCheckStatusTransition} */
        it(&quot;should do get call if userToken, paperCheckToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPaperCheckStatusTransition(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
    describe(&quot;listPaperCheckStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaperCheckStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
        it(&quot;should throw error if paperCheckToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaperCheckStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;paperCheckToken is required&quot;);
        });

        /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listPaperCheckStatusTransitions(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaperCheckStatusTransitions(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPaperCheckStatusTransitions(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listPaperCheckStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPaperCheckStatusTransitions(&quot;test-user-token&quot;, &quot;test-paper-check-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paper-checks/test-paper-check-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Transfers
    //--------------------------------------

    /** @test {Hyperwallet#createTransfer} */
    describe(&quot;createTransfer()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createTransfer} */
        it(&quot;should throw error if sourceToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createTransfer({
                test: &quot;value&quot;,
            }, callback)).to.throw(&quot;sourceToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransfer} */
        it(&quot;should throw error if destinationToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createTransfer({
                sourceToken: &quot;sourceToken&quot;,
            }, callback)).to.throw(&quot;destinationToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransfer} */
        it(&quot;should throw error if clientTransferId is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createTransfer({
                sourceToken: &quot;sourceToken&quot;,
                destinationToken: &quot;destinationToken&quot;,
            }, callback)).to.throw(&quot;clientTransferId is required&quot;);
        });

        /** @test {Hyperwallet#createTransfer} */
        it(&quot;should do post call to transfers endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createTransfer({
                sourceToken: &quot;sourceToken&quot;,
                destinationToken: &quot;destinationToken&quot;,
                clientTransferId: &quot;clientTransferId&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers&quot;, {
                sourceToken: &quot;sourceToken&quot;,
                destinationToken: &quot;destinationToken&quot;,
                clientTransferId: &quot;clientTransferId&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getTransfer} */
    describe(&quot;getTransfer()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getTransfer} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransfer(undefined, callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransfer} */
        it(&quot;should do get call if transferToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getTransfer(&quot;test-transfer-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listTransfers} */
    describe(&quot;listTransfers()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listTransfers} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                clientTransferId: &quot;test-clientTransferId&quot;,
                sourceToken: &quot;test-sourceToken&quot;,
                destinationToken: &quot;test-destinationToken&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listTransfers(options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers&quot;, options);
        });

        /** @test {Hyperwallet#listTransfers} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransfers({ clientTransferId: &quot;test-clientTransferId&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - clientTransferId,sourceToken,destinationToken,createdBefore,createdAfter,limit&quot;);
        });

        /** @test {Hyperwallet#listTransfers} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransfers({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers&quot;, {});
        });

        /** @test {Hyperwallet#listTransfers} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listTransfers({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#createTransferStatusTransition} */
    describe(&quot;createTransferStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createTransferStatusTransition} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createTransferStatusTransition(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransferStatusTransition} */
        it(&quot;should send post call to transfer status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createTransferStatusTransition(&quot;test-transfer-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    //--------------------------------------
    // Transfer Refunds
    //--------------------------------------

    /** @test {Hyperwallet#createTransferRefund} */
    describe(&quot;createTransferRefund()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createTransferRefund} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createTransferRefund(undefined, {
                clientRefundId: &quot;value&quot;,
            }, callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransferRefund} */
        it(&quot;should throw error if clientRefundId is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createTransferRefund(&quot;test-transfer-token&quot;, {
                test: &quot;value&quot;,
            }, callback)).to.throw(&quot;clientRefundId is required&quot;);
        });

        /** @test {Hyperwallet#createTransferRefund} */
        it(&quot;should do post call to transfer refunds endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createTransferRefund(&quot;test-transfer-token&quot;, {
                clientRefundId: &quot;clientRefundId&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/refunds&quot;, {
                clientRefundId: &quot;clientRefundId&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getTransferRefund} */
    describe(&quot;getTransferRefund()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getTransferRefund} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferRefund(undefined, &quot;test-transfer-refund-token&quot;,
                callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransferRefund} */
        it(&quot;should throw error if transferRefundToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferRefund(&quot;test-transfer-token&quot;, undefined,
                callback)).to.throw(&quot;transferRefundToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransferRefund} */
        it(&quot;should do get call if transferToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getTransferRefund(&quot;test-transfer-token&quot;, &quot;test-transfer-refund-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/refunds/test-transfer-refund-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listTransferRefunds} */
    describe(&quot;listTransferRefunds()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listTransferRefunds} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferRefunds(undefined, {
                test: &quot;value&quot;,
            }, callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#listTransferRefunds} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferRefunds(&quot;test-transfer-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/refunds&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listTransferRefunds} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferRefunds(&quot;test-transfer-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/refunds&quot;, {});
        });

        /** @test {Hyperwallet#listTransferRefunds} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listTransferRefunds(&quot;test-transfer-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/refunds&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // PayPal accounts
    //--------------------------------------

    /** @test {Hyperwallet#createPayPalAccount} */
    describe(&quot;createPayPalAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPayPalAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPayPalAccount(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPayPalAccount} */
        it(&quot;should throw error if transferMethodCountry is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPayPalAccount(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback)).to.throw(&quot;transferMethodCountry is required&quot;);
        });

        /** @test {Hyperwallet#createPayPalAccount} */
        it(&quot;should throw error if transferMethodCurrency is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPayPalAccount(&quot;test-user-token&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
            }, callback)).to.throw(&quot;transferMethodCurrency is required&quot;);
        });

        /** @test {Hyperwallet#createPayPalAccount} */
        it(&quot;should throw error if email is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPayPalAccount(&quot;test-user-token&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
                transferMethodCurrency: &quot;test-transferMethodCurrency&quot;,
            }, callback)).to.throw(&quot;email is required&quot;);
        });

        /** @test {Hyperwallet#createPayPalAccount} */
        it(&quot;should do post call to PayPal account endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPayPalAccount(&quot;test-user-token&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
                transferMethodCurrency: &quot;test-transferMethodCurrency&quot;,
                email: &quot;email&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
                transferMethodCurrency: &quot;test-transferMethodCurrency&quot;,
                email: &quot;email&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPayPalAccount} */
    describe(&quot;getPayPalAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPayPalAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayPalAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayPalAccount} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayPalAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayPalAccount} */
        it(&quot;should do get call if userToken and payPalAccountToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPayPalAccount(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPayPalAccounts} */
    describe(&quot;listPayPalAccounts()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPayPalAccounts} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPayPalAccounts(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPayPalAccounts} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                status: &quot;test-status&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listPayPalAccounts(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts&quot;, options);
        });

        /** @test {Hyperwallet#listPayPalAccounts} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPayPalAccounts(&quot;test-user-token&quot;, { status: &quot;test-status&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPayPalAccounts} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPayPalAccounts(&quot;test-user-token&quot;, {}, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts&quot;, {});
        });

        /** @test {Hyperwallet#listPayPalAccounts} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPayPalAccounts(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#updatePayPalAccount} */
    describe(&quot;updatePayPalAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updatePayPalAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePayPalAccount(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePayPalAccount} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePayPalAccount(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePayPalAccount} */
        it(&quot;should do put call to paypal account endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updatePayPalAccount(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#activatePayPalAccount} */
    describe(&quot;activatePayPalAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#activatePayPalAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.activatePayPalAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#activatePayPalAccount} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.activatePayPalAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#activatePayPalAccount} */
        it(&quot;should send transition to &apos;ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.activatePayPalAccount(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions&quot;, {
                transition: &quot;ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#deactivatePayPalAccount} */
    describe(&quot;deactivatePayPalAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#deactivatePayPalAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivatePayPalAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivatePayPalAccount} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivatePayPalAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivatePayPalAccount} */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivatePayPalAccount(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createPayPalAccountStatusTransition} */
    describe(&quot;createPayPalAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPayPalAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPayPalAccountStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPayPalAccountStatusTransition} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPayPalAccountStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#createPayPalAccountStatusTransition} */
        it(&quot;should send post call to paypal account status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPayPalAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPayPalAccountStatusTransition} */
    describe(&quot;getPayPalAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPayPalAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayPalAccountStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayPalAccountStatusTransition} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayPalAccountStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayPalAccountStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayPalAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayPalAccountStatusTransition} */
        it(&quot;should do get call if userToken, payPalAccountToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPayPalAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
    describe(&quot;listPayPalAccountStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPayPalAccountStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
        it(&quot;should throw error if payPalAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPayPalAccountStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;payPalAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPayPalAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, { transition: &quot;test-transition&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions&quot;, { transition: &quot;test-transition&quot; });
        });

        /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPayPalAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPayPalAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listPayPalAccountStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });
                cb();
            };
            client.listPayPalAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-paypal-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/paypal-accounts/test-paypal-account-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Prepaid Cards
    //--------------------------------------

    /** @test {Hyperwallet#createPrepaidCard} */
    describe(&quot;createPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPrepaidCard(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPrepaidCard} */
        it(&quot;should do post call to prepaid cards endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPrepaidCard(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPrepaidCard} */
    describe(&quot;getPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCard(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCard(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCard} */
        it(&quot;should do get call if userToken and prepaidCardToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updatePrepaidCard} */
    describe(&quot;updatePrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updatePrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePrepaidCard(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updatePrepaidCard(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#updatePrepaidCard} */
        it(&quot;should do put call to prepaid cards endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updatePrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPrepaidCards} */
    describe(&quot;listPrepaidCards()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCards(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                status: &quot;test-status&quot;, createdBefore: &quot;test-createdBefore&quot;, createdAfter: &quot;test-createdBefore&quot;, sortBy: &quot;test-sortBy&quot;, limit: &quot;test-limit&quot;,
            };
            client.listPrepaidCards(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, options);
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCards(&quot;test-user-token&quot;, { status: &quot;test-status&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPrepaidCards(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, {});
        });

        /** @test {Hyperwallet#listPrepaidCards} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPrepaidCards(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    const PREPAID_CARD_STATUS_CHANGE_METHODS = {
        suspend: &quot;SUSPENDED&quot;,
        unsuspend: &quot;UNSUSPENDED&quot;,
        lostOrStolen: &quot;LOST_OR_STOLEN&quot;,
        deactivate: &quot;DE_ACTIVATED&quot;,
        lock: &quot;LOCKED&quot;,
        unlock: &quot;UNLOCKED&quot;,
    };
    Object.keys(PREPAID_CARD_STATUS_CHANGE_METHODS).forEach((method) =&gt; {
        const methodName = `${method}PrepaidCard`;

        describe(`${methodName}()`, () =&gt; {
            let client;
            let apiClientSpy;

            beforeEach(() =&gt; {
                apiClientSpy = sinon.spy();
                client = new Hyperwallet({
                    username: &quot;test-username&quot;,
                    password: &quot;test-password&quot;,
                });
                client.client = {
                    doPost: apiClientSpy,
                };
            });

            /**
             * @test {Hyperwallet#suspendPrepaidCard}
             * @test {Hyperwallet#unsuspendPrepaidCard}
             * @test {Hyperwallet#lostOrStolenPrepaidCard}
             * @test {Hyperwallet#deactivatePrepaidCard}
             * @test {Hyperwallet#lockPrepaidCard}
             * @test {Hyperwallet#unlockPrepaidCard}
             */
            it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
                const callback = () =&gt; null;
                expect(() =&gt; client[methodName](undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
            });

            /**
             * @test {Hyperwallet#suspendPrepaidCard}
             * @test {Hyperwallet#unsuspendPrepaidCard}
             * @test {Hyperwallet#lostOrStolenPrepaidCard}
             * @test {Hyperwallet#deactivatePrepaidCard}
             * @test {Hyperwallet#lockPrepaidCard}
             * @test {Hyperwallet#unlockPrepaidCard}
             */
            it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
                const callback = () =&gt; null;
                expect(() =&gt; client[methodName](&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
            });

            /**
             * @test {Hyperwallet#suspendPrepaidCard}
             * @test {Hyperwallet#unsuspendPrepaidCard}
             * @test {Hyperwallet#lostOrStolenPrepaidCard}
             * @test {Hyperwallet#deactivatePrepaidCard}
             * @test {Hyperwallet#lockPrepaidCard}
             * @test {Hyperwallet#unlockPrepaidCard}
             */
            it(`should send transition to &apos;${PREPAID_CARD_STATUS_CHANGE_METHODS[method]}&apos;`, () =&gt; {
                const callback = () =&gt; null;
                client[methodName](&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, callback);

                apiClientSpy.should.have.been.calledOnce();
                apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {
                    transition: PREPAID_CARD_STATUS_CHANGE_METHODS[method],
                }, {}, callback);
            });
        });
    });

    /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
    describe(&quot;createPrepaidCardStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPrepaidCardStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPrepaidCardStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#createPrepaidCardStatusTransition} */
        it(&quot;should send post call to prepaid card status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPrepaidCardStatusTransition(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
    describe(&quot;getPrepaidCardStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCardStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCardStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPrepaidCardStatusTransition(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getPrepaidCardStatusTransition} */
        it(&quot;should do get call if userToken, prepaidCardToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPrepaidCardStatusTransition(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
    describe(&quot;listPrepaidCardStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCardStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listPrepaidCardStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPrepaidCardStatusTransitions(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Bank Accounts
    //--------------------------------------

    /** @test {Hyperwallet#createBankAccount} */
    describe(&quot;createBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankAccount(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankAccount} */
        it(&quot;should do post call to bank accounts endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBankAccount(&quot;test-user-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getBankAccount} */
    describe(&quot;getBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccount} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccount} */
        it(&quot;should do get call if userToken and bankAccountToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getBankAccount(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#updateBankAccount} */
    describe(&quot;updateBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBankAccount(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBankAccount} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBankAccount(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBankAccount} */
        it(&quot;should do put call to bank accounts endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateBankAccount(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBankAccounts} */
    describe(&quot;listBankAccounts()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccounts(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });
        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                type: &quot;test-type&quot;,
                status: &quot;test-status&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listBankAccounts(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, options);
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccounts(&quot;test-user-token&quot;, { type: &quot;test-type&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - type,status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankAccounts(&quot;test-user-token&quot;, {}, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, {});
        });
        /** @test {Hyperwallet#listBankAccounts} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBankAccounts(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#deactivateBankAccount} */
    describe(&quot;deactivateBankAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#deactivateBankAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBankAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateBankAccount} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBankAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateBankAccount} */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivateBankAccount(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createBankAccountStatusTransition} */
    describe(&quot;createBankAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBankAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankAccountStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankAccountStatusTransition} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBankAccountStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#createBankAccountStatusTransition} */
        it(&quot;should send post call to prepaid card status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBankAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getBankAccountStatusTransition} */
    describe(&quot;getBankAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getBankAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccountStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccountStatusTransition} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccountStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccountStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBankAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getBankAccountStatusTransition} */
        it(&quot;should do get call if userToken, bankAccountToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getBankAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBankAccountStatusTransitions} */
    describe(&quot;listBankAccountStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccountStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });
        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should throw error if bankAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;bankAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listBankAccountStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBankAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-bank-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/bank-accounts/test-bank-account-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Balances
    //--------------------------------------

    /** @test {Hyperwallet#listBalancesForUser} */
    describe(&quot;listBalancesForUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForUser(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = { currency: &quot;test-currency&quot;, limit: &quot;test-limit&quot; };
            client.listBalancesForUser(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/balances&quot;, options);
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForUser(&quot;test-user-token&quot;, { currency: &quot;test-currency&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - currency,limit&quot;);
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/balances&quot;, {});
        });

        /** @test {Hyperwallet#listBalancesForUser} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBalancesForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/balances&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listBalancesForPrepaidCard} */
    describe(&quot;listBalancesForPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForPrepaidCard(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { sortBy: &quot;test-sortBy&quot;, limit: &quot;test-limit&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/balances&quot;, { sortBy: &quot;test-sortBy&quot;, limit: &quot;test-limit&quot; });
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { sortBy: &quot;test-sortBy&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/balances&quot;, {});
        });

        /** @test {Hyperwallet#listBalancesForPrepaidCard} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBalancesForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/balances&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listBalancesForAccount} */
    describe(&quot;listBalancesForAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForAccount(undefined, undefined, {}, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should throw error if accountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForAccount(&quot;test-program-token&quot;, undefined, {}, callback)).to.throw(&quot;accountToken is required&quot;);
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, { currency: &quot;test-currency&quot;, sortBy: &quot;test-sortBy&quot;, limit: &quot;test-limit&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/balances&quot;, { currency: &quot;test-currency&quot;, sortBy: &quot;test-sortBy&quot;, limit: &quot;test-limit&quot; });
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, { currency: &quot;test-currency&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - currency,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/balances&quot;, {});
        });

        /** @test {Hyperwallet#listBalancesForAccount} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBalancesForAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/balances&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Payments
    //--------------------------------------

    /** @test {Hyperwallet#createPayment} */
    describe(&quot;createPayment()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPayment} */
        it(&quot;should do post call to payments endpoint without programToken added&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPayment({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });

        /** @test {Hyperwallet#createPayment} */
        it(&quot;should do post call to payments endpoint with programToken added&quot;, () =&gt; {
            client.programToken = &quot;test-program-token&quot;;

            const callback = () =&gt; null;
            client.createPayment({
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {
                test: &quot;value&quot;,
                programToken: &quot;test-program-token&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPayment} */
    describe(&quot;getPayment()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPayment} */
        it(&quot;should throw error if paymentToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPayment(undefined, callback)).to.throw(&quot;paymentToken is required&quot;);
        });

        /** @test {Hyperwallet#getPayment} */
        it(&quot;should do get call if paymentToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPayment(&quot;test-payment-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPayments} */
    describe(&quot;listPayments()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                clientPaymentId: &quot;test-client-payment-id&quot;,
                releaseDate: &quot;test-releaseDate&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listPayments(options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, options);
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPayments({ clientPaymentId: &quot;test-client-payment-id&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - clientPaymentId,releaseDate,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPayments({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {});
        });

        /** @test {Hyperwallet#listPayments} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPayments({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#createPaymentStatusTransition} */
    describe(&quot;createPaymentStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createPaymentStatusTransition} */
        it(&quot;should throw error if paymentToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createPaymentStatusTransition(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;paymentToken is required&quot;);
        });

        /** @test {Hyperwallet#createPaymentStatusTransition} */
        it(&quot;should send post call to payment status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createPaymentStatusTransition(&quot;test-payment-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getPaymentStatusTransition} */
    describe(&quot;getPaymentStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getPaymentStatusTransition} */
        it(&quot;should throw error if paymentToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaymentStatusTransition(undefined, undefined, callback)).to.throw(&quot;paymentToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaymentStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getPaymentStatusTransition(&quot;test-payment-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getPaymentStatusTransition} */
        it(&quot;should do get call if paymentToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getPaymentStatusTransition(&quot;test-payment-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listPaymentStatusTransitions} */
    describe(&quot;listPaymentStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listPaymentStatusTransitions} */
        it(&quot;should throw error if paymentToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaymentStatusTransitions(undefined, {}, callback)).to.throw(&quot;paymentToken is required&quot;);
        });

        /** @test {Hyperwallet#listPaymentStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listPaymentStatusTransitions(&quot;test-payment-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listPaymentStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listPaymentStatusTransitions(&quot;test-payment-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listPaymentStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listPaymentStatusTransitions(&quot;test-payment-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listPaymentStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listPaymentStatusTransitions(&quot;test-payment-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;payments/test-payment-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Programs
    //--------------------------------------

    /** @test {Hyperwallet#getProgram} */
    describe(&quot;getProgram()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getProgram} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getProgram(undefined, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#getProgram} */
        it(&quot;should do get call if programToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getProgram(&quot;test-program-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token&quot;, {}, callback);
        });
    });

    //--------------------------------------
    // Program Accounts
    //--------------------------------------

    /** @test {Hyperwallet#getProgramAccount} */
    describe(&quot;getProgramAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getProgramAccount} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getProgramAccount(undefined, undefined, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#getProgramAccount} */
        it(&quot;should throw error if accountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getProgramAccount(&quot;test-program-token&quot;, undefined, callback)).to.throw(&quot;accountToken is required&quot;);
        });

        /** @test {Hyperwallet#getProgramAccount} */
        it(&quot;should do get call if programToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token&quot;, {}, callback);
        });
    });

    //--------------------------------------
    // Transfer Method Configurations
    //--------------------------------------

    /** @test {Hyperwallet#getTransferMethodConfiguration} */
    describe(&quot;getTransferMethodConfiguration()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(undefined, undefined, undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if country is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, undefined, undefined, undefined, undefined, callback)).to.throw(&quot;country is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if currency is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, undefined, undefined, undefined, callback)).to.throw(&quot;currency is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if type is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, &quot;test-currency&quot;, undefined, undefined, callback)).to.throw(&quot;type is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should throw error if profileType is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, &quot;test-currency&quot;, &quot;test-type&quot;, undefined, callback)).to.throw(&quot;profileType is required&quot;);
        });

        /** @test {Hyperwallet#getTransferMethodConfiguration} */
        it(&quot;should do get call if userToken, country, currency, type and profileType is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getTransferMethodConfiguration(&quot;test-user-token&quot;, &quot;test-country&quot;, &quot;test-currency&quot;, &quot;test-type&quot;, &quot;test-profile-type&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                userToken: &quot;test-user-token&quot;,
                country: &quot;test-country&quot;,
                currency: &quot;test-currency&quot;,
                type: &quot;test-type&quot;,
                profileType: &quot;test-profile-type&quot;,
            }, callback);
        });
    });

    /** @test {Hyperwallet#listTransferMethodConfigurations} */
    describe(&quot;listTransferMethodConfigurations()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferMethodConfigurations(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = { userToken: &quot;test-userToken&quot;, limit: &quot;test-limit&quot; };
            client.listTransferMethodConfigurations(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            options.userToken = &quot;test-user-token&quot;;
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, options);
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferMethodConfigurations(&quot;test-user-token&quot;, { userToken: &quot;test-userToken&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - userToken,limit&quot;);
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferMethodConfigurations(&quot;test-user-token&quot;, undefined, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                userToken: &quot;test-user-token&quot;,
            });
        });

        /** @test {Hyperwallet#listTransferMethodConfigurations} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listTransferMethodConfigurations(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfer-method-configurations&quot;, {
                userToken: &quot;test-user-token&quot;,
            });

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    describe(&quot;createTransferMethod()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createTransferMethod} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            const userToken = null;
            const cacheToken = null;

            expect(() =&gt; client.createTransferMethod(userToken, cacheToken, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransferMethod} */
        it(&quot;should throw error if cacheToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            const userToken = &quot;test-user-token&quot;;
            const cacheToken = null;

            expect(() =&gt; client.createTransferMethod(userToken, cacheToken, callback)).to.throw(&quot;jsonCacheToken is required&quot;);
        });

        /** @test {Hyperwallet#createTransferMethod} */
        it(&quot;should do post call with userToken and cacheToken&quot;, () =&gt; {
            const callback = () =&gt; null;
            const userToken = &quot;test-user-token&quot;;
            const cacheToken = &quot;test-cache-token&quot;;
            client.createTransferMethod(userToken, cacheToken, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/transfer-methods&quot;, { test: &quot;value&quot; }, { &quot;Json-Cache-Token&quot;: &quot;test-cache-token&quot; });
        });
    });

    //--------------------------------------
    // Receipts
    //--------------------------------------

    /** @test {Hyperwallet#listReceiptsForProgramAccount} */
    describe(&quot;listReceiptsForProgramAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should throw error if programToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForProgramAccount(undefined, undefined, {}, callback)).to.throw(&quot;programToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should throw error if accountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, undefined, {}, callback)).to.throw(&quot;accountToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, { currency: &quot;test-currency&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/receipts&quot;, { currency: &quot;test-currency&quot; });
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, { currency: &quot;test-currency&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - currency,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/receipts&quot;, {});
        });

        /** @test {Hyperwallet#listReceiptsForProgramAccount} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listReceiptsForProgramAccount(&quot;test-program-token&quot;, &quot;test-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;programs/test-program-token/accounts/test-account-token/receipts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listReceiptsForUser} */
    describe(&quot;listReceiptsForUser()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForUser(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForUser(&quot;test-user-token&quot;, { createdBefore: &quot;test-createdBefore&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/receipts&quot;, { createdBefore: &quot;test-createdBefore&quot; });
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForUser(&quot;test-user-token&quot;, { createdBefore: &quot;test-createdBefore&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/receipts&quot;, {});
        });

        /** @test {Hyperwallet#listReceiptsForUser} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listReceiptsForUser(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/receipts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
    describe(&quot;listReceiptsForPrepaidCard()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForPrepaidCard(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should throw error if prepaidCardToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;prepaidCardToken is required&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { createdBefore: &quot;test-createdBefore&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/receipts&quot;, { createdBefore: &quot;test-createdBefore&quot; });
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, { createdBefore: &quot;test-createdBefore&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - createdBefore,createdAfter&quot;);
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/receipts&quot;, {});
        });

        /** @test {Hyperwallet#listReceiptsForPrepaidCard} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listReceiptsForPrepaidCard(&quot;test-user-token&quot;, &quot;test-prepaid-card-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/prepaid-cards/test-prepaid-card-token/receipts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Webhooks
    //--------------------------------------

    describe(&quot;listWebhookNotifications()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                programToken: &quot;test-programToken&quot;,
                type: &quot;test-type&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdAfter&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listWebhookNotifications(options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications&quot;, options);
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listWebhookNotifications({ programToken: &quot;test-programToken&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - programToken,createdBefore,createdAfter,type,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listWebhookNotifications({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications&quot;, {});
        });

        /** @test {Hyperwallet#listWebhookNotifications} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listWebhookNotifications({}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    describe(&quot;getWebhookNotification&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getWebhookNotification} */
        it(&quot;should throw error if webhookToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getWebhookNotification(undefined, {}, callback)).to.throw(&quot;webhookToken is required&quot;);
        });

        /** @test {Hyperwallet#getWebhookNotification} */
        it(&quot;should do get call if webhookToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getWebhookNotification(&quot;webhook-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;webhook-notifications/webhook-token&quot;, {}, callback);
        });
    });

    //--------------------------------------
    // Internal utils
    //--------------------------------------

    describe(&quot;addProgramToken()&quot;, () =&gt; {
        it(&quot;should do nothing if no data is provided&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            expect(client.addProgramToken()).to.be.undefined();
        });

        it(&quot;should do nothing if no programToken is set&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });

            client.addProgramToken({ test: &quot;value&quot; }).should.be.deep.equal({ test: &quot;value&quot; });
        });

        it(&quot;should do nothing if programToken is set in data&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                programToken: &quot;test-program-token&quot;,
            });

            client.addProgramToken({ test: &quot;value&quot;, programToken: &quot;my-program-token&quot; }).should.be.deep.equal({ test: &quot;value&quot;, programToken: &quot;my-program-token&quot; });
        });

        it(&quot;should add programToken if no programToken is set in data&quot;, () =&gt; {
            const client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
                programToken: &quot;test-program-token&quot;,
            });

            client.addProgramToken({ test: &quot;value&quot; }).should.be.deep.equal({ test: &quot;value&quot;, programToken: &quot;test-program-token&quot; });
        });
    });

    describe(&quot;handle204Response()&quot;, () =&gt; {
        it(&quot;should return a &apos;function&apos; with a argument&quot;, () =&gt; {
            Hyperwallet.handle204Response(() =&gt; null).should.be.a(&quot;function&quot;);
        });

        it(&quot;should do nothing for errors&quot;, (cb) =&gt; {
            const providedErr = new Error(&quot;Test&quot;);
            const providedData = {
                test: &quot;value&quot;,
            };
            const providedRes = {
                status: 200,
            };

            const callback = Hyperwallet.handle204Response((err, data, res) =&gt; {
                err.should.be.deep.equal(providedErr);
                data.should.be.deep.equal(providedData);
                res.should.be.deep.equal(providedRes);

                cb();
            });
            callback(providedErr, providedData, providedRes);
        });

        it(&quot;should do nothing for non 204 responses&quot;, (cb) =&gt; {
            const providedData = {
                test: &quot;value&quot;,
            };
            const providedRes = {
                status: 200,
            };

            const callback = Hyperwallet.handle204Response((err, data, res) =&gt; {
                expect(err).to.be.undefined();

                data.should.be.deep.equal(providedData);
                res.should.be.deep.equal(providedRes);

                cb();
            });
            callback(undefined, providedData, providedRes);
        });

        it(&quot;should return empty list for 204 responses&quot;, (cb) =&gt; {
            const providedData = {
                test: &quot;value&quot;,
            };
            const providedRes = {
                status: 204,
            };

            const callback = Hyperwallet.handle204Response((err, data, res) =&gt; {
                expect(err).to.be.undefined();

                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });
                res.should.be.deep.equal(providedRes);

                cb();
            });
            callback(undefined, providedData, providedRes);
        });
    });

    //--------------------------------------
    // Venmo accounts
    //--------------------------------------

    /** @test {Hyperwallet#createVenmoAccount} */
    describe(&quot;createVenmoAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createVenmoAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createVenmoAccount(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createVenmoAccount} */
        it(&quot;should throw error if transferMethodCountry is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createVenmoAccount(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback)).to.throw(&quot;transferMethodCountry is required&quot;);
        });

        /** @test {Hyperwallet#createVenmoAccount} */
        it(&quot;should throw error if transferMethodCurrency is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createVenmoAccount(&quot;test-user-token&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
            }, callback)).to.throw(&quot;transferMethodCurrency is required&quot;);
        });

        /** @test {Hyperwallet#createVenmoAccount} */
        it(&quot;should throw error if accountId is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createVenmoAccount(&quot;test-user-token&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
                transferMethodCurrency: &quot;test-transferMethodCurrency&quot;,
            }, callback)).to.throw(&quot;Account is required&quot;);
        });

        /** @test {Hyperwallet#createVenmoAccount} */
        it(&quot;should do post call to venmo account endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createVenmoAccount(&quot;test-user-token&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
                transferMethodCurrency: &quot;test-transferMethodCurrency&quot;,
                accountId: &quot;accountId&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts&quot;, {
                transferMethodCountry: &quot;test-transferMethodCountry&quot;,
                transferMethodCurrency: &quot;test-transferMethodCurrency&quot;,
                accountId: &quot;accountId&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getVenmoAccount} */
    describe(&quot;getVenmoAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getVenmoAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getVenmoAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getVenmoAccount} */
        it(&quot;should throw error if venmoAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getVenmoAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;venmoAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getVenmoAccount} */
        it(&quot;should do get call if userToken and venmoAccountToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getVenmoAccount(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listVenmoAccounts} */
    describe(&quot;listVenmoAccounts()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listVenmoAccounts} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listVenmoAccounts(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listVenmoAccounts} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                type: &quot;test-type&quot;,
                status: &quot;test-status&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listVenmoAccounts(&quot;test-user-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts&quot;, options);
        });

        /** @test {Hyperwallet#listVenmoAccounts} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listVenmoAccounts(&quot;test-user-token&quot;, { type: &quot;test-type&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - type,status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listVenmoAccounts} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listVenmoAccounts(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts&quot;, {});
        });

        /** @test {Hyperwallet#listVenmoAccounts} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listVenmoAccounts(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#updateVenmoAccount} */
    describe(&quot;updateVenmoAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateVenmoAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateVenmoAccount(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateVenmoAccount} */
        it(&quot;should throw error if venmoAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateVenmoAccount(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;venmoAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#updateVenmoAccount} */
        it(&quot;should do put call to venmo accounts endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateVenmoAccount(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#deactivateVenmoAccount} */
    describe(&quot;deactivateVenmoAccount()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#deactivateVenmoAccount} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateVenmoAccount(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateVenmoAccount} */
        it(&quot;should throw error if venmoAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateVenmoAccount(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;venmoAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateVenmoAccount} */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivateVenmoAccount(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createVenmoAccountStatusTransition} */
    describe(&quot;createVenmoAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createVenmoAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createVenmoAccountStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createVenmoAccountStatusTransition} */
        it(&quot;should throw error if venmoAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createVenmoAccountStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;venmoAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#createVenmoAccountStatusTransition} */
        it(&quot;should send post call to venmo account status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createVenmoAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });


    /** @test {Hyperwallet#getVenmoAccountStatusTransition} */
    describe(&quot;getVenmoAccountStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getVenmoAccountStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getVenmoAccountStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getVenmoAccountStatusTransition} */
        it(&quot;should throw error if venmoAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getVenmoAccountStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;venmoAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#getVenmoAccountStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getVenmoAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getVenmoAccountStatusTransition} */
        it(&quot;should do get call if userToken, venmoAccountToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getVenmoAccountStatusTransition(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
    describe(&quot;listVenmoAccountStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listVenmoAccountStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
        it(&quot;should throw error if venmoAccountToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listVenmoAccountStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;venmoAccountToken is required&quot;);
        });

        /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            const options = {
                transition: &quot;test-transition&quot;,
                createdBefore: &quot;test-createdBefore&quot;,
                createdAfter: &quot;test-createdBefore&quot;,
                sortBy: &quot;test-sortBy&quot;,
                limit: &quot;test-limit&quot;,
            };
            client.listVenmoAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, options, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token/status-transitions&quot;, options);
        });

        /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listVenmoAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listVenmoAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listVenmoAccountStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listVenmoAccountStatusTransitions(&quot;test-user-token&quot;, &quot;test-venmo-account-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/venmo-accounts/test-venmo-account-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    //--------------------------------------
    // Business StakeHolder
    //--------------------------------------

    /** @test {Hyperwallet#createBusinessStakeholder} */
    describe(&quot;createBusinessStakeholder()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createStakeholder} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBusinessStakeholder(undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createStakeholder} */
        it(&quot;should send post call to Stakeholder status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBusinessStakeholder(&quot;test-user-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBusinessStakeholders} */
    describe(&quot;listBusinessStakeholders()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBusinessStakeholders} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBusinessStakeholders(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBusinessStakeholders} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBusinessStakeholders(&quot;test-user-token&quot;, { status: &quot;test-status&quot; }, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders&quot;, { status: &quot;test-status&quot; });
        });

        /** @test {Hyperwallet#listBusinessStakeholders} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBusinessStakeholders(&quot;test-user-token&quot;, { status: &quot;test-status&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - status,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listBusinessStakeholders} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBusinessStakeholders(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders&quot;, {});
        });

        /** @test {Hyperwallet#listBusinessStakeholders} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBusinessStakeholders(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#updateBusinessStakeholder} */
    describe(&quot;updateBusinessStakeholder()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPut: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#updateBusinessStakeholder} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBusinessStakeholder(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBusinessStakeholder} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.updateBusinessStakeholder(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#updateBusinessStakeholder} */
        it(&quot;should do put call to Stakeholder endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.updateBusinessStakeholder(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#deactivateBusinessStakeholder} */
    describe(&quot;deactivateBusinessStakeholder()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#deactivateBusinessStakeholder} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBusinessStakeholder(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateBusinessStakeholder} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.deactivateBusinessStakeholder(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#deactivateBusinessStakeholder} */
        it(&quot;should send transition to &apos;DE_ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.deactivateBusinessStakeholder(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions&quot;, {
                transition: &quot;DE_ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#activateBusinessStakeholder} */
    describe(&quot;activateBusinessStakeholder()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#activateBusinessStakeholder} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.activateBusinessStakeholder(undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#activateBusinessStakeholder} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.activateBusinessStakeholder(&quot;test-user-token&quot;, undefined, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#activateBusinessStakeholder} */
        it(&quot;should send transition to &apos;ACTIVATED&apos;&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.activateBusinessStakeholder(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions&quot;, {
                transition: &quot;ACTIVATED&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#createBusinessStakeholderStatusTransition} */
    describe(&quot;createBusinessStakeholderStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPost: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#createBusinessStakeholderStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBusinessStakeholderStatusTransition(undefined, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#createBusinessStakeholderStatusTransition} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.createBusinessStakeholderStatusTransition(&quot;test-user-token&quot;, undefined, { test: &quot;value&quot; }, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#createBusinessStakeholderStatusTransition} */
        it(&quot;should send post call to StakeHolder status transition endpoint&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.createBusinessStakeholderStatusTransition(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, { test: &quot;value&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions&quot;, {
                test: &quot;value&quot;,
            }, {}, callback);
        });
    });

    /** @test {Hyperwallet#getBusinessStakeholderStatusTransition} */
    describe(&quot;getBusinessStakeholderStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getBusinessStakeholderStatusTransition} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBusinessStakeholderStatusTransition(undefined, undefined, undefined, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#getBusinessStakeholderStatusTransition} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBusinessStakeholderStatusTransition(&quot;test-user-token&quot;, undefined, undefined, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#getBusinessStakeholderStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getBusinessStakeholderStatusTransition(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getBusinessStakeholderStatusTransition} */
        it(&quot;should do get call if userToken, stakeholderToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getBusinessStakeholderStatusTransition(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, &quot;status-transition-token&quot;, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions/status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
    describe(&quot;listBusinessStakeholderStatusTransitions()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBusinessStakeholderStatusTransitions(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBusinessStakeholderStatusTransitions(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBusinessStakeholderStatusTransitions(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, { transition: &quot;test-transition&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions&quot;, { transition: &quot;test-transition&quot; });
        });

        /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listBusinessStakeholderStatusTransitions(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, { transition: &quot;test-transition&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - transition,createdBefore,createdAfter,sortBy,offset,limit&quot;);
        });

        /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listBusinessStakeholderStatusTransitions(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listBusinessStakeholderStatusTransitions} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listBusinessStakeholderStatusTransitions(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/business-stakeholders/test-stakeholder-token/status-transitions&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    describe(&quot;uploadBusinessStakeholderDocuments()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doPutMultipart: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#uploadBusinessStakeholderDocuments} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.uploadBusinessStakeholderDocuments(undefined, undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#uploadBusinessStakeholderDocuments} */
        it(&quot;should throw error if stakeholderToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.uploadBusinessStakeholderDocuments(&quot;test-user-token&quot;, undefined, {}, callback)).to.throw(&quot;stakeholderToken is required&quot;);
        });

        /** @test {Hyperwallet#uploadBusinessStakeholderDocuments} */
        it(&quot;should throw error if data is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.uploadBusinessStakeholderDocuments(&quot;test-user-token&quot;, &quot;test-stakeholder-token&quot;, null, callback)).to.throw(&quot;Files for upload are require&quot;);
        });

        /** @test {Hyperwallet#uploadBusinessStakeholderDocuments} */
        it(&quot;should do put call to upload multipart&quot;, () =&gt; {
            const callback = () =&gt; null;

            client.uploadBusinessStakeholderDocuments(&quot;users/test-user-token&quot;, &quot;test-stakeholder-token&quot;, {
                test: &quot;value&quot;,
            }, callback);

            apiClientSpy.should.have.been.calledOnce();
        });
    });

    /** @test {Hyperwallet#listTransferMethods} */
    describe(&quot;listTransferMethods()&quot;, () =&gt; {
        let client;
        let apiClientSpy;

        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listTransferMethods} */
        it(&quot;should throw error if userToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferMethods(undefined, {}, callback)).to.throw(&quot;userToken is required&quot;);
        });

        /** @test {Hyperwallet#listTransferMethods} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferMethods(&quot;test-user-token&quot;, { status: &quot;test-status&quot; }, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/transfer-methods&quot;, { status: &quot;test-status&quot; });
        });

        /** @test {Hyperwallet#listTransferMethods} */
        it(&quot;should throw error for invalid filter&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferMethods(&quot;test-user-token&quot;, { status: &quot;test-status&quot;, test: &quot;value&quot; }, callback))
                .to.throw(&quot;Invalid Filter. Expected - status,type,createdBefore,createdAfter,sortBy,limit&quot;);
        });

        /** @test {Hyperwallet#listTransferMethods} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferMethods(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/transfer-methods&quot;, {});
        });

        /** @test {Hyperwallet#listTransferMethods} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });

                cb();
            };
            client.listTransferMethods(&quot;test-user-token&quot;, {}, callback);

            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;users/test-user-token/transfer-methods&quot;, {});

            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });

    /** @test {Hyperwallet#getTransferStatusTransition} */
    describe(&quot;getTransferStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;
        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#getTransferStatusTransition} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferStatusTransition(undefined, undefined, callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransferStatusTransition} */
        it(&quot;should throw error if statusTransitionToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.getTransferStatusTransition(&quot;test-transfer-token&quot;, undefined, callback)).to.throw(&quot;statusTransitionToken is required&quot;);
        });

        /** @test {Hyperwallet#getTransferStatusTransition} */
        it(&quot;should do get call if transferToken and statusTransitionToken is provided&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.getTransferStatusTransition(&quot;test-transfer-token&quot;, &quot;test-status-transition-token&quot;, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/status-transitions/test-status-transition-token&quot;, {}, callback);
        });
    });

    /** @test {Hyperwallet#listTransferStatusTransition} */
    describe(&quot;listTransferStatusTransition()&quot;, () =&gt; {
        let client;
        let apiClientSpy;
        beforeEach(() =&gt; {
            apiClientSpy = sinon.spy();
            client = new Hyperwallet({
                username: &quot;test-username&quot;,
                password: &quot;test-password&quot;,
            });
            client.client = {
                doGet: apiClientSpy,
            };
        });

        /** @test {Hyperwallet#listTransferStatusTransition} */
        it(&quot;should throw error if transferToken is missing&quot;, () =&gt; {
            const callback = () =&gt; null;
            expect(() =&gt; client.listTransferStatusTransition(undefined, {}, callback)).to.throw(&quot;transferToken is required&quot;);
        });

        /** @test {Hyperwallet#listTransferStatusTransition} */
        it(&quot;should do get call with options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferStatusTransition(&quot;test-transfer-token&quot;, { test: &quot;value&quot; }, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/status-transitions&quot;, { test: &quot;value&quot; });
        });

        /** @test {Hyperwallet#listTransferStatusTransition} */
        it(&quot;should do get call without options&quot;, () =&gt; {
            const callback = () =&gt; null;
            client.listTransferStatusTransition(&quot;test-transfer-token&quot;, {}, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/status-transitions&quot;, {});
        });

        /** @test {Hyperwallet#listTransferStatusTransition} */
        it(&quot;should handle 204 return&quot;, (cb) =&gt; {
            const callback = (err, data) =&gt; {
                data.should.be.deep.equal({
                    hasNextPage: false,
                    hasPreviousPage: false,
                    limit: 0,
                    data: [],
                });
                cb();
            };
            client.listTransferStatusTransition(&quot;test-transfer-token&quot;, {}, callback);
            apiClientSpy.should.have.been.calledOnce();
            apiClientSpy.should.have.been.calledWith(&quot;transfers/test-transfer-token/status-transitions&quot;, {});
            apiClientSpy.getCall(0).args[2](undefined, {}, {
                status: 204,
            });
        });
    });
});
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
